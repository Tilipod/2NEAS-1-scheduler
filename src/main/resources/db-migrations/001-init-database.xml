<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet id="20220401-1000" author="tilipod">

        <createTable tableName="task">

            <column type="bigint" name="id" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column type="uuid" name="process_id">
                <constraints nullable="false" unique="true"/>
            </column>

            <column type="varchar" name="json_network_structure">
                <constraints nullable="false"/>
            </column>

            <column type="varchar" name="status">
                <constraints nullable="false"/>
            </column>

            <column type="varchar" name="comment"/>

            <column type="timestamptz" name="created_date_time">
                <constraints nullable="false"/>
            </column>

            <column type="timestamptz" name="last_updated_date_time">
                <constraints nullable="false"/>
            </column>

        </createTable>

        <createTable tableName="neuron_network">

            <column type="bigint" name="id" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column type="boolean" name="with_mentoring" defaultValue="false"/>

            <column type="varchar" name="path_to_model">
                <constraints nullable="false" unique="true"/>
            </column>

            <column type="bigint" name="count_outputs">
                <constraints nullable="false"/>
            </column>

            <column type="bigint" name="task_id">
                <constraints nullable="false" unique="true" foreignKeyName="neuron_network_task_foreign_key"
                             references="task(id)" deleteCascade="true"/>
            </column>

            <column type="timestamptz" name="created_date_time">
                <constraints nullable="false"/>
            </column>

            <column type="timestamptz" name="last_updated_date_time">
                <constraints nullable="false"/>
            </column>

        </createTable>

        <createTable tableName="course">

            <column type="bigint" name="id" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column type="bigint" name="current_epoch" defaultValue="0">
                <constraints nullable="false"/>
            </column>

            <column type="bigint" name="count_epoch">
                <constraints nullable="false"/>
            </column>

            <column type="bigint" name="neuron_network_id">
                <constraints nullable="false" unique="true" foreignKeyName="course_neuron_network_foreign_key"
                             references="neuron_network(id)" deleteCascade="true"/>
            </column>

            <column type="timestamptz" name="created_date_time">
                <constraints nullable="false"/>
            </column>

            <column type="timestamptz" name="last_updated_date_time">
                <constraints nullable="false"/>
            </column>

        </createTable>

        <createTable tableName="distribution">

            <column type="bigint" name="id" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column type="varchar" name="dataset_type">
                <constraints nullable="false"/>
            </column>

            <column type="varchar" name="path_to_remote_dataset">
                <constraints nullable="false" unique="true"/>
            </column>

            <column type="varchar" name="path_to_local_dataset">
                <constraints nullable="false" unique="true"/>
            </column>

            <column type="varchar" name="cloud_type">
                <constraints nullable="false"/>
            </column>

            <column type="varchar" name="cloud_token">
                <constraints nullable="false"/>
            </column>

            <column type="bigint" name="task_id">
                <constraints nullable="false" unique="true" foreignKeyName="distribution_task_foreign_key"
                             references="task(id)" deleteCascade="true"/>
            </column>

            <column type="timestamptz" name="created_date_time">
                <constraints nullable="false"/>
            </column>

            <column type="timestamptz" name="last_updated_date_time">
                <constraints nullable="false"/>
            </column>

        </createTable>

    </changeSet>



</databaseChangeLog>
